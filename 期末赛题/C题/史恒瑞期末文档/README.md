# PEARSON分析以及代码：
## excel表格以及代码说明：
分类品种	辣椒		水生根茎		花叶		食用菌		茄类		花菜	
时间	成本加成定价	销量	成本加成定价	销量	成本加成定价	销量	成本加成定价	销量	成本加成定价	销量	成本加成定价	销量
2020/7/1	8.13808	54.548	12.925	4.119	3.91264	14.748	20.4876	7.693	4.2004	17.713	15.2964	34.554
2020/7/2	8.5376	1.667	12.925	4.342	6.8172	11.556	22.53636	17.345	4.2004	17.767	10.5354	13.834
2020/7/3	8.13808	32.351	12.925	9.572	12.784	3.478	22.53636	15.29	7.4249	17.553	9.3648	15.616
2020/7/4	8.5376	3.948	12.925	3.107	4.40172	9.638	7.2401	16.702	4.2004	24.022	15.2964	42.815
2020/7/5	12.936	8.475	12.925	4.019	9.22	34.249	22.53636	18.406	4.2004	24.423	15.2964	42.365
2020/7/6	15.4252	10.36	12.925	3.089	4.8908	14.098	22.53636	13.35	8.4856	8.96	15.2964	24.434
2020/7/7	8.5664	8.51	12.925	3.117	6.7686	28.214	7.86068	16.797	8.4856	14.6	10.5354	22.699
2020/7/8	15.4252	20.043	16.8864	8.239	17.2144	5.33	22.53636	14.827	8.4856	18.588	10.5354	20.792
只取了前几行进行说明，第一行为分类品种，第二行为时间以及每一类的当天的成本加成定价以及销量，选取每一个品类每天的成本加成定价以及销量

对于py文件的运行原理如下：

首先，通过pd.read_excel方法读取了一个Excel文件，选取了名为Sheet1的工作表，并指定了要使用的列范围以及跳过的行数。

随后，针对数据框中的NaN和inf值(也就是文件里面的空白值)，通过replace和fillna方法将其替换为0，这有助于避免在计算相关系数和进行统计检验时出现错误。

接着，使用循环遍历计算了数据框中各列之间的皮尔逊相关系数以及对应的P值，并将结果存储在corr_matrix和p_values_matrix中。

然后，代码中利用Jarque-Bera检验检验了数据的正态性，并打印了H值和对应的P值。

接下来，代码中进行了相关系数的显著性检验。首先，获取用户输入的样本数量和显著性检验判断值。然后，根据公式计算了相关系数的t值和相应的P值，并对P值进行了检验，在此例中输出了相关系数显著性的判断结果。

# 回归方程txt文件以及代码说明：
## txt文件：

文件内容与上述PEARSON内容相同，只是转成了txt文件，但是没有再添加第一行的分类品种，便于读取计算结果

## py文件:

计算时选取每一个品类的成本加成定价以及销量，对于每一个类型提取不同天的成本加成定价以及销量拟合线性回归模型。然后通过遍历数据的不同列，对每一组数据进行线性回归拟合，从而实现目的

# 模拟退火和优化模型
## 未来一周预测.xlsx:
根据上半年的数据对未来一周的数据量进行模拟得出结果预测一周的量

## 平均损耗率.xlsx：
每种品类损耗率的平均值

## S1.xlsx：
每种品类的单位成本价格

## 代码：
首先读取数据：通过xlsread函数从Excel文件中读取了定价数据以及未来一周的销量预测数据和平均损耗率数据。

参数初始化：初始化了模拟退火算法的参数，包括变量个数、初始温度、最大迭代次数等。

随机生成初始解矩阵：在指定的定义域内随机生成了一个初始解，并计算了当前解的函数值。

模拟退火过程：包括外循环和内循环，用于在每个温度下进行广泛搜索新解，并根据Metropolis准则决定是否接受新解，同时迭代中温度会逐渐降低。

目标函数定义：定义了一个目标函数Obj_fun2，该函数针对给定的解和数据计算目标函数值，并在模拟退火过程中被调用。

最后输出最佳的位置以及最优值